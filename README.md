# Домашнее задание к занятию "Репликация и масштабирование. Часть 1" - `Хамов Олег`

### Задание 1

1. Репликация Master-Slave

Процесс репликации подразумевает собой распространение изменений данных с главного

сервера (обычно он называется как мастер, master), на один или более подчиненных

серверов (слейв, slave). Существуют и более сложные конфигурации, в частности с

несколькими мастер-серверами, но для каждого изменения на конкретном мастер-сервере

остальные мастера условно становятся слейвами, и потребляют эти изменения.

В общем виде, репликация в MySQL состоит из трех шагов:

    1. Мастер-сервер записывает изменения данных в журнал. Этот журнал называется двоичным журналом (binary log), а изменения — событиями двоичного журнала.

    2. Слейв копирует изменения двоичного журнала в свой, который называется журналом ретрансляции (relay log).

    3. Слейв воспроизводит изменения из журнала ретрансляции, применяя их к собственным данным.

Таким образом, в слейв сервер записываются все изменения происходящие в мастер-

сервере, который постоянно отправляет запросы слейву и тот записывает изменения. Но

процесс этот ассинхонный, что позволяет не держать постоянно подключение к мастер-серверу.

2. Репликация Master-Master

Master-Master репликация. В этом варианте репликации оба сервера могут быть мастер-

серверами и соответственно оба они могут вносить изменения и читать данные друг у

друга, и эти изменения дублируются на оба сервера. Опасность состоит в том, что если

использовать асинхронную репликацию мастер-мастер, в режиме active-active, не зная

тонкостей, то можно столкнуться с ситуацией, когда обе ноды, например, внесут

одинаковую строку в таблицу, что приведет к ошибке, или попытаются одновременно

внести изменения в одну и ту же строку. Тем не менее, этот вариант рабочий и его

активно используют, например:

    • для создания горячего «почти» актуального бэкапа

    • для кластеризации чтений с MySQL слейвов

    • для вертикального шардинга (фильтруем какие таблицы на какие слейвы переносить)

    • для того, чтобы спокойно бэкапить Slave-сервер с помощью mysqldump, не нагружая боевой сервер БД

Но мастер-мастер, можно использовать и в режиме active-passive или использовать,

разрабатываемую синхронную мастер-мастер репликацию – Galera.

Таким образом, главное отличие между двумя представленными выше схемами, состоит в

том, что в режиме master-slave, master производит операции записи и чтения, а slave-

сервера могут только принимать запросы на чтение. В master-master же обе ноды могут

производить операции записи и чтения. При этом, master-master вариант более

рискованный, не смотря на то, что работает несколько быстрее первой схемы.

### Задание 2

Выполнил конфигурацию master-slave репликации:

![1.png](https://github.com/oleghamov/Replik-Mashtab-12-06-16-11-23-hw-/blob/master/1.png)`

![2.png](https://github.com/oleghamov/Replik-Mashtab-12-06-16-11-23-hw-/blob/master/2.png)`

![3.png](https://github.com/oleghamov/Replik-Mashtab-12-06-16-11-23-hw-/blob/master/3.png)`

![4.png](https://github.com/oleghamov/Replik-Mashtab-12-06-16-11-23-hw-/blob/master/4.png)`

![5.png](https://github.com/oleghamov/Replik-Mashtab-12-06-16-11-23-hw-/blob/master/5.png)`


